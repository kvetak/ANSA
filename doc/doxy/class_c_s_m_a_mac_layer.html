<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>INET Framework for OMNeT++/OMNEST: CSMAMacLayer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">INET Framework for OMNeT++/OMNEST</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_c_s_m_a_mac_layer.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">CSMAMacLayer Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="CSMAMacLayer" --><!-- doxytag: inherits="WirelessMacBase,INotifiable" -->
<p>MAC module which provides non-persistent CSMA.  
 <a href="class_c_s_m_a_mac_layer.html#details">More...</a></p>

<p><code>#include &lt;CSMAMacLayer.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CSMAMacLayer:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_c_s_m_a_mac_layer.png" usemap="#CSMAMacLayer_map" alt=""/>
  <map id="CSMAMacLayer_map" name="CSMAMacLayer_map">
<area href="class_wireless_mac_base.html" alt="WirelessMacBase" shape="rect" coords="0,0,113,24"/>
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="123,0,236,24"/>
</map>
 </div></div>

<p><a href="class_c_s_m_a_mac_layer-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a52ea80af0023e1d7002d4bdbc6ae39cc">CSMAMacLayer</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a670e9734cd2d4300fb9dd23f1873409f">~CSMAMacLayer</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#af0b2c470ab7f10fe061cf2daf9907e39">initialize</a> (int)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization of the module and some variables.  <a href="#af0b2c470ab7f10fe061cf2daf9907e39"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#ade403acd57e58a03f974b7f48a32d734">registerInterface</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Register the interface in <a class="el" href="class_interface_table.html">InterfaceTable</a>.  <a href="#ade403acd57e58a03f974b7f48a32d734"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#aeaffa0655b4e87224a9a2f09b96805d7">finish</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete all dynamically allocated objects of the module.  <a href="#aeaffa0655b4e87224a9a2f09b96805d7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a131f9fa39f15a2e1a995a5581ba05fb1">handleLowerMsg</a> (cPacket *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle packets from lower layer.  <a href="#a131f9fa39f15a2e1a995a5581ba05fb1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#ad4e68633095418d62399d0eaa8a4b0ce">handleCommand</a> (cMessage *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle commands from upper layer.  <a href="#ad4e68633095418d62399d0eaa8a4b0ce"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a6df436f9290586658dc48738d7cd2160">handleUpperMsg</a> (cPacket *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle packets from upper layer.  <a href="#a6df436f9290586658dc48738d7cd2160"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a254a29c1cc1f0292039d57c1d189cda3">handleSelfMsg</a> (cMessage *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle self messages such as timers.  <a href="#a254a29c1cc1f0292039d57c1d189cda3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual MacPkt *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#adf48e62e08023a725d932f6fb6d59d28">encapsMsg</a> (cPacket *netw)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Encapsulate the given higher-layer packet into MacPkt.  <a href="#adf48e62e08023a725d932f6fb6d59d28"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a086c3e39266c68e144bd6443797a4051">receiveChangeNotification</a> (int category, const cPolymorphic *details)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by the <a class="el" href="class_notification_board.html">NotificationBoard</a> whenever a change occurs we're interested in.  <a href="#a086c3e39266c68e144bd6443797a4051"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_m_a_c_address.html">MACAddress</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#afdf97d7f96e7f3af317915cb8c67fb46">myMacAddr</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">mac address  <a href="#afdf97d7f96e7f3af317915cb8c67fb46"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_radio_state.html#a9b2ff8c4d3f1cdb73af0a9fcea0d5449">RadioState::State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a8cef547042b1676d1ddce0dea22f0191">radioState</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Current state of the radio (kept updated by <a class="el" href="class_c_s_m_a_mac_layer.html#a086c3e39266c68e144bd6443797a4051" title="Called by the NotificationBoard whenever a change occurs we&#39;re interested in.">receiveChangeNotification()</a>)  <a href="#a8cef547042b1676d1ddce0dea22f0191"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cQueue&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a7520d042d75476c466a6c22b2f39677a">macQueue</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A queue to store packets from upper layer in case another packet is still waiting for transmission..  <a href="#a7520d042d75476c466a6c22b2f39677a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a592653908837e5acbe36dfe7f20efbdd">queueLength</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">length of the queue  <a href="#a592653908837e5acbe36dfe7f20efbdd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf">timer</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Timer for backoff in case the channel is busy.  <a href="#a4aa3b46aa38d83fd86f2ef499caa48bf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">simtime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_s_m_a_mac_layer.html#ab7ea060c217bbfb8a06bc39c1dfeaa9f">sendTime</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to store the last time a message was sent.  <a href="#ab7ea060c217bbfb8a06bc39c1dfeaa9f"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>MAC module which provides non-persistent CSMA. </p>
<p>This is an implementation of a simple non-persistent CSMA. The idea of nonpersistent CSMA is "listen before talk". Before attempting to transmit, a station will sense the medium for a carrier signal, which, if present, indicates that some other station is sending.</p>
<p>If the channel is busy a random waiting time is computed and after this time the channel is sensed again. Once the channel gets idle the message is sent. (State of the channel is obtained from <a class="el" href="class_snr_eval.html" title="Keeps track of the different snir levels when receiving a packet.">SnrEval</a> via <a class="el" href="class_notification_board.html">NotificationBoard</a>.)</p>
<p>An option of this module is to use a queue. If a packet from the upper layer arrives although there is still another packet waiting for its transmission or being transmitted the new packet can be stored in this queue. The length of this queue can be specified by the user in the omnetpp.ini file. By default the length is 0. If the queue is full or there is no queue (length = 0) new packet(s) will be deleted.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Inform upper layers about the full queue!</dd></dl>
<p>ATTENTION: Imagine the following scenario:</p>
<p>Several stations receive a broadcast request packet, usally exactly at the same time. They will all try to answer at exactly the same time, i.e. they all will sense the channel at exactly the same time and start to transmit because the channel was sensed idle by all of them. Therefore a small random delay should be built into one/some of the upper layers to simulate a random processing time!</p>
<p>The TestApplLayer e.g. implements such a processing delay!</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Marc Lï¿½bbers, Yosia Hadisusanto </dd></dl>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a52ea80af0023e1d7002d4bdbc6ae39cc"></a><!-- doxytag: member="CSMAMacLayer::CSMAMacLayer" ref="a52ea80af0023e1d7002d4bdbc6ae39cc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CSMAMacLayer::CSMAMacLayer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf" title="Timer for backoff in case the channel is busy.">timer</a> = NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a670e9734cd2d4300fb9dd23f1873409f"></a><!-- doxytag: member="CSMAMacLayer::~CSMAMacLayer" ref="a670e9734cd2d4300fb9dd23f1873409f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CSMAMacLayer::~CSMAMacLayer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
    cancelAndDelete(<a class="code" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf" title="Timer for backoff in case the channel is busy.">timer</a>);
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="adf48e62e08023a725d932f6fb6d59d28"></a><!-- doxytag: member="CSMAMacLayer::encapsMsg" ref="adf48e62e08023a725d932f6fb6d59d28" args="(cPacket *netw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MacPkt * CSMAMacLayer::encapsMsg </td>
          <td>(</td>
          <td class="paramtype">cPacket *&#160;</td>
          <td class="paramname"><em>netw</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encapsulate the given higher-layer packet into MacPkt. </p>
<p>Encapsulates the received network-layer packet into a MacPkt and set all needed header fields. </p>

<p>Referenced by <a class="el" href="class_c_s_m_a_mac_layer.html#a6df436f9290586658dc48738d7cd2160">handleUpperMsg()</a>.</p>
<div class="fragment"><pre class="fragment">{
    MacPkt *pkt = <span class="keyword">new</span> MacPkt(netw-&gt;getName());
    pkt-&gt;setBitLength(272);

    <span class="comment">// copy dest address from the Control Info attached to the network</span>
    <span class="comment">// mesage by the network layer</span>
    Ieee802Ctrl *ctrl = check_and_cast&lt;Ieee802Ctrl *&gt;(netw-&gt;removeControlInfo());

    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;ctrl removed, mac addr=&quot;</span> &lt;&lt; ctrl-&gt;getDest() &lt;&lt; endl;
    pkt-&gt;setDestAddr(ctrl-&gt;getDest());

    <span class="comment">//delete the control info</span>
    <span class="keyword">delete</span> ctrl;

    <span class="comment">//set the src address to own mac address</span>
    pkt-&gt;setSrcAddr(<a class="code" href="class_c_s_m_a_mac_layer.html#afdf97d7f96e7f3af317915cb8c67fb46" title="mac address">myMacAddr</a>);

    <span class="comment">//encapsulate the network packet</span>
    pkt-&gt;encapsulate(netw);
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;pkt encapsulated\n&quot;</span>;

    <span class="keywordflow">return</span> pkt;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aeaffa0655b4e87224a9a2f09b96805d7"></a><!-- doxytag: member="CSMAMacLayer::finish" ref="aeaffa0655b4e87224a9a2f09b96805d7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSMAMacLayer::finish </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Delete all dynamically allocated objects of the module. </p>
<div class="fragment"><pre class="fragment">{
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad4e68633095418d62399d0eaa8a4b0ce"></a><!-- doxytag: member="CSMAMacLayer::handleCommand" ref="ad4e68633095418d62399d0eaa8a4b0ce" args="(cMessage *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSMAMacLayer::handleCommand </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle commands from upper layer. </p>

<p>Implements <a class="el" href="class_wireless_mac_base.html#a2a5fd20a6064b4754954638bc93f8d8d">WirelessMacBase</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// no commands supported by CSMAMacLayer</span>
    error(<span class="stringliteral">&quot;Non-packet message arrived from higher layer: (%s)%s&quot;</span>, msg-&gt;getClassName(), msg-&gt;getName());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a131f9fa39f15a2e1a995a5581ba05fb1"></a><!-- doxytag: member="CSMAMacLayer::handleLowerMsg" ref="a131f9fa39f15a2e1a995a5581ba05fb1" args="(cPacket *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSMAMacLayer::handleLowerMsg </td>
          <td>(</td>
          <td class="paramtype">cPacket *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle packets from lower layer. </p>
<p>Compare the address of this Host with the destination address in frame. If they are equal or the frame is broadcast, we send this frame to the upper layer. If not delete it. </p>

<p>Implements <a class="el" href="class_wireless_mac_base.html#ab1db1fa4fd9ecec9d8fa1a38a9a365e1">WirelessMacBase</a>.</p>
<div class="fragment"><pre class="fragment">{
    MacPkt *mac = check_and_cast&lt;MacPkt *&gt;(msg);

    <span class="comment">//only foward to upper layer if message is for me or broadcast</span>
    <span class="keywordflow">if</span> (mac-&gt;getDestAddr() == <a class="code" href="class_c_s_m_a_mac_layer.html#afdf97d7f96e7f3af317915cb8c67fb46" title="mac address">myMacAddr</a> || mac-&gt;getDestAddr().<a class="code" href="class_m_a_c_address.html#aa65a288ef8fe0e08e66912ffda5e3706">isBroadcast</a>())
    {
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;sending pkt to upper...\n&quot;</span>;
        <a class="code" href="class_wireless_mac_base.html#a5454ec5040663e5af4ddb00f525a3caf" title="Sends a message to the upper layer.">sendUp</a>(mac);
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;packet not for me, deleting...\n&quot;</span>;
        <span class="keyword">delete</span> mac;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a254a29c1cc1f0292039d57c1d189cda3"></a><!-- doxytag: member="CSMAMacLayer::handleSelfMsg" ref="a254a29c1cc1f0292039d57c1d189cda3" args="(cMessage *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSMAMacLayer::handleSelfMsg </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle self messages such as timers. </p>
<p>After the timer expires try to retransmit the message by calling handleUpperMsg again. </p>

<p>Implements <a class="el" href="class_wireless_mac_base.html#a1c7f3c2581f66d7de17af4a730ae0c4d">WirelessMacBase</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;timer expired, calling handleUpperMsg again.. time: &quot;</span> &lt;&lt; simTime() &lt;&lt; endl;

    <span class="comment">// timer expired for a buffered frame, try to send again</span>
    <a class="code" href="class_c_s_m_a_mac_layer.html#a6df436f9290586658dc48738d7cd2160" title="Handle packets from upper layer.">handleUpperMsg</a>((MacPkt *) msg-&gt;getContextPointer());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6df436f9290586658dc48738d7cd2160"></a><!-- doxytag: member="CSMAMacLayer::handleUpperMsg" ref="a6df436f9290586658dc48738d7cd2160" args="(cPacket *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSMAMacLayer::handleUpperMsg </td>
          <td>(</td>
          <td class="paramtype">cPacket *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle packets from upper layer. </p>
<p>First it has to be checked whether a frame is currently being transmitted or waiting to be transmitted. If so the newly arrived message is stored in a queue. If there is no queue or it is full print a warning.</p>
<p>Before transmitting a frame it is tested whether the channel is busy at the moment or not. If the channel is busy, a short random time will be generated and the MacPkt is buffered for this time, before a next attempt to send the packet is started.</p>
<p>If channel is idle the frame will be transmitted immediately. </p>

<p>Implements <a class="el" href="class_wireless_mac_base.html#ab44661d865472b3799cbe4b086e131b9">WirelessMacBase</a>.</p>

<p>Referenced by <a class="el" href="class_c_s_m_a_mac_layer.html#a254a29c1cc1f0292039d57c1d189cda3">handleSelfMsg()</a>.</p>
<div class="fragment"><pre class="fragment">{
    MacPkt *mac = <a class="code" href="class_c_s_m_a_mac_layer.html#adf48e62e08023a725d932f6fb6d59d28" title="Encapsulate the given higher-layer packet into MacPkt.">encapsMsg</a>(msg);

    <span class="comment">// message has to be queued if another message is waiting to be send</span>
    <span class="comment">// or if we are already trying to send another message</span>

    <span class="comment">// the comparison with sendTime is necessary so that concurrently</span>
    <span class="comment">// arriving messages are handled sequentially. As soon as one</span>
    <span class="comment">// message arrived at simTime() is passed to lower layers all other</span>
    <span class="comment">// messages arriving at the same time will be buffered.</span>
    <span class="keywordflow">if</span> (<a class="code" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf" title="Timer for backoff in case the channel is busy.">timer</a>-&gt;isScheduled() || <a class="code" href="class_c_s_m_a_mac_layer.html#a8cef547042b1676d1ddce0dea22f0191" title="Current state of the radio (kept updated by receiveChangeNotification())">radioState</a> == <a class="code" href="class_radio_state.html#a9b2ff8c4d3f1cdb73af0a9fcea0d5449aedb2522a6da55abd014a306192411a11">RadioState::TRANSMIT</a> || <a class="code" href="class_c_s_m_a_mac_layer.html#ab7ea060c217bbfb8a06bc39c1dfeaa9f" title="Used to store the last time a message was sent.">sendTime</a> == simTime())
    {

        <span class="comment">// if there is no queue the message will be deleted</span>
        <span class="keywordflow">if</span> (<a class="code" href="class_c_s_m_a_mac_layer.html#a592653908837e5acbe36dfe7f20efbdd" title="length of the queue">queueLength</a> == 0)
        {
            <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;New packet arrived though another is still waiting for being sent, &quot;</span>
                <span class="stringliteral">&quot; and buffer size is zero. New packet is deleted.\n&quot;</span>;
            <span class="comment">// TODO: Signal this to upper layer!</span>
            <span class="keyword">delete</span> mac;
            <span class="keywordflow">return</span>;
        }

        <span class="comment">// the queue is not full yet so we can queue the message</span>
        <span class="keywordflow">if</span> (<a class="code" href="class_c_s_m_a_mac_layer.html#a7520d042d75476c466a6c22b2f39677a" title="A queue to store packets from upper layer in case another packet is still waiting for transmission...">macQueue</a>.length() &lt; <a class="code" href="class_c_s_m_a_mac_layer.html#a592653908837e5acbe36dfe7f20efbdd" title="length of the queue">queueLength</a>)
        {
            <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;already transmitting, putting pkt into queue...\n&quot;</span>;
            <a class="code" href="class_c_s_m_a_mac_layer.html#a7520d042d75476c466a6c22b2f39677a" title="A queue to store packets from upper layer in case another packet is still waiting for transmission...">macQueue</a>.insert(mac);
            <span class="keywordflow">return</span>;
        }
        <span class="comment">// queue is full, message has to be deleted</span>
        <span class="keywordflow">else</span>
        {
            <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;New packet arrived, but queue is FULL, so new packet is deleted\n&quot;</span>;
            <span class="comment">// TODO: Signal this to upper layer!!</span>
            <span class="keyword">delete</span> mac;
            <span class="keywordflow">return</span>;
        }
    }

    <span class="comment">// no message is scheduled for sending or currently being sent</span>

    <span class="comment">// check the radio status and transmit the message if the channel is</span>
    <span class="comment">// idle. Otherwise backoff for a random time and try again</span>
    <span class="keywordflow">if</span> (<a class="code" href="class_c_s_m_a_mac_layer.html#a8cef547042b1676d1ddce0dea22f0191" title="Current state of the radio (kept updated by receiveChangeNotification())">radioState</a> == <a class="code" href="class_radio_state.html#a9b2ff8c4d3f1cdb73af0a9fcea0d5449aeb600ab2fbbbbc2d12d874edb9320ec0">RadioState::IDLE</a>)
    {
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;CHANNEL IDLE, send...\n&quot;</span>;
        <a class="code" href="class_wireless_mac_base.html#a97af424876ed4fc77702d183f38dc83c" title="Sends a message to the lower layer.">sendDown</a>(mac);
        <span class="comment">//store the sending time</span>
        <a class="code" href="class_c_s_m_a_mac_layer.html#ab7ea060c217bbfb8a06bc39c1dfeaa9f" title="Used to store the last time a message was sent.">sendTime</a> = simTime();
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf" title="Timer for backoff in case the channel is busy.">timer</a>-&gt;setContextPointer(mac);
        simtime_t randomTime = intuniform(0, 10) / 100.0;
        scheduleAt(simTime() + randomTime, <a class="code" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf" title="Timer for backoff in case the channel is busy.">timer</a>);
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;CHANNEL BUSY, I will try to retransmit at &quot;</span> &lt;&lt; simTime() + randomTime &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="af0b2c470ab7f10fe061cf2daf9907e39"></a><!-- doxytag: member="CSMAMacLayer::initialize" ref="af0b2c470ab7f10fe061cf2daf9907e39" args="(int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSMAMacLayer::initialize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialization of the module and some variables. </p>

<p>Reimplemented from <a class="el" href="class_wireless_mac_base.html#a74866aacf342c21cd220d959698d87af">WirelessMacBase</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_c_s_m_a_mac_layer.html#af0b2c470ab7f10fe061cf2daf9907e39" title="Initialization of the module and some variables.">WirelessMacBase::initialize</a>(stage);

    <span class="keywordflow">if</span> (stage == 0)
    {
        <a class="code" href="class_c_s_m_a_mac_layer.html#a592653908837e5acbe36dfe7f20efbdd" title="length of the queue">queueLength</a> = hasPar(<span class="stringliteral">&quot;queueLength&quot;</span>) ? (int)par(<span class="stringliteral">&quot;queueLength&quot;</span>) : 0;
        <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;queueLength = &quot;</span> &lt;&lt; <a class="code" href="class_c_s_m_a_mac_layer.html#a592653908837e5acbe36dfe7f20efbdd" title="length of the queue">queueLength</a> &lt;&lt; endl;

        <span class="comment">//subscribe for the information of the carrier sense</span>
        <a class="code" href="class_wireless_mac_base.html#a779ea8a0af7e4ef85c5faa85d6a281ed" title="Cached pointer to the NotificationBoard module.">nb</a>-&gt;<a class="code" href="class_notification_board.html#aeb02a282e6c807c1cb064a28e8409ff2">subscribe</a>(<span class="keyword">this</span>, <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55baa6e69ccdaad903262ac00b89b6208a69">NF_RADIOSTATE_CHANGED</a>);

        <span class="comment">// initialize the timer</span>
        <a class="code" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf" title="Timer for backoff in case the channel is busy.">timer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;backoff&quot;</span>);

        <a class="code" href="class_c_s_m_a_mac_layer.html#a8cef547042b1676d1ddce0dea22f0191" title="Current state of the radio (kept updated by receiveChangeNotification())">radioState</a> = <a class="code" href="class_radio_state.html#a9b2ff8c4d3f1cdb73af0a9fcea0d5449aeb600ab2fbbbbc2d12d874edb9320ec0">RadioState::IDLE</a>; <span class="comment">// until 1st receiveChangeNotification()</span>

        <span class="comment">// get registered in IInterfaceTable</span>
        <a class="code" href="class_c_s_m_a_mac_layer.html#ade403acd57e58a03f974b7f48a32d734" title="Register the interface in InterfaceTable.">registerInterface</a>();
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a086c3e39266c68e144bd6443797a4051"></a><!-- doxytag: member="CSMAMacLayer::receiveChangeNotification" ref="a086c3e39266c68e144bd6443797a4051" args="(int category, const cPolymorphic *details)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSMAMacLayer::receiveChangeNotification </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>category</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cPolymorphic *&#160;</td>
          <td class="paramname"><em>details</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called by the <a class="el" href="class_notification_board.html">NotificationBoard</a> whenever a change occurs we're interested in. </p>
<p>Update the internal copy of the <a class="el" href="class_radio_state.html">RadioState</a>.</p>
<p>If the <a class="el" href="class_radio_state.html">RadioState</a> switched from TRANSMIT to IDLE and there are still messages in the queue, call handleUpperMsg in order to try to send those now. </p>

<p>Implements <a class="el" href="class_i_notifiable.html#a67d757190e1128eaec8f0a8e51ed38f6">INotifiable</a>.</p>
<div class="fragment"><pre class="fragment">{
    Enter_Method(<span class="stringliteral">&quot;receiveChangeNotification(%s, %s)&quot;</span>, <a class="code" href="_notifier_consts_8cc.html#a6808a262fcec2a310a9e7ed7d75c029f">notificationCategoryName</a>(category),
                 details?details-&gt;info().c_str() : <span class="stringliteral">&quot;n/a&quot;</span>);
    <a class="code" href="_notifier_consts_8cc.html#a68fd4b933fae636048bb9ee52fd922e5">printNotificationBanner</a>(category, details);

    <span class="keywordflow">if</span> (category == <a class="code" href="_notifier_consts_8h.html#a06fc87d81c62e9abb8790b6e5713c55baa6e69ccdaad903262ac00b89b6208a69">NF_RADIOSTATE_CHANGED</a>)
    {
        <span class="comment">// update the local copy of the radio state</span>
        <a class="code" href="class_c_s_m_a_mac_layer.html#a8cef547042b1676d1ddce0dea22f0191" title="Current state of the radio (kept updated by receiveChangeNotification())">radioState</a> = check_and_cast&lt;<a class="code" href="class_radio_state.html">RadioState</a> *&gt;(details)-&gt;getState();

        <span class="comment">// NOTE: we may be invoked during INIT STAGE 1 too, when SnrEval notifies us</span>
        <span class="comment">// about the initial radio state. This function has to work correctly</span>
        <span class="comment">// even when called during initialization phase!</span>

        <span class="comment">// if the channel is idle now, the queue is not empty and no timer</span>
        <span class="comment">// is scheduled, this means that sending the previous message is</span>
        <span class="comment">// complete and the next one can be taken out of the queue</span>
        <span class="keywordflow">if</span> (<a class="code" href="class_c_s_m_a_mac_layer.html#a8cef547042b1676d1ddce0dea22f0191" title="Current state of the radio (kept updated by receiveChangeNotification())">radioState</a> == <a class="code" href="class_radio_state.html#a9b2ff8c4d3f1cdb73af0a9fcea0d5449aeb600ab2fbbbbc2d12d874edb9320ec0">RadioState::IDLE</a> &amp;&amp; !<a class="code" href="class_c_s_m_a_mac_layer.html#a7520d042d75476c466a6c22b2f39677a" title="A queue to store packets from upper layer in case another packet is still waiting for transmission...">macQueue</a>.empty() &amp;&amp; !<a class="code" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf" title="Timer for backoff in case the channel is busy.">timer</a>-&gt;isScheduled())
        {
            <a class="code" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf" title="Timer for backoff in case the channel is busy.">timer</a>-&gt;setContextPointer(<a class="code" href="class_c_s_m_a_mac_layer.html#a7520d042d75476c466a6c22b2f39677a" title="A queue to store packets from upper layer in case another packet is still waiting for transmission...">macQueue</a>.pop());
            simtime_t randomTime = intuniform(0, 10) / 100.0;
            scheduleAt(simTime() + randomTime, <a class="code" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf" title="Timer for backoff in case the channel is busy.">timer</a>);
            <a class="code" href="_i_n_e_t_defs_8h.html#a650ef3eff8a2900bef69dae29c05d2dd">EV</a> &lt;&lt; <span class="stringliteral">&quot;taking next pkt out of queue, schedule at &quot;</span> &lt;&lt; simTime() + randomTime &lt;&lt; endl;
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ade403acd57e58a03f974b7f48a32d734"></a><!-- doxytag: member="CSMAMacLayer::registerInterface" ref="ade403acd57e58a03f974b7f48a32d734" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSMAMacLayer::registerInterface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Register the interface in <a class="el" href="class_interface_table.html">InterfaceTable</a>. </p>

<p>Referenced by <a class="el" href="class_c_s_m_a_mac_layer.html#af0b2c470ab7f10fe061cf2daf9907e39">initialize()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *e = <span class="keyword">new</span> <a class="code" href="class_interface_entry.html">InterfaceEntry</a>();

    <span class="comment">// interface name: NetworkInterface module&#39;s name without special characters ([])</span>
    <span class="keywordtype">char</span> *interfaceName = <span class="keyword">new</span> <span class="keywordtype">char</span>[strlen(getParentModule()-&gt;getFullName()) + 1];
    <span class="keywordtype">char</span> *d = interfaceName;
    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *s = getParentModule()-&gt;getFullName(); *s; s++)
        <span class="keywordflow">if</span> (isalnum(*s))
            *d++ = *s;
    *d = <span class="charliteral">&#39;\0&#39;</span>;

    e-&gt;<a class="code" href="class_interface_entry.html#af9ca0c7af3a0f45e7d7102e6cc2b089e">setName</a>(interfaceName);
    <span class="keyword">delete</span> [] interfaceName;

    <span class="keyword">const</span> <span class="keywordtype">char</span> *addrstr = par(<span class="stringliteral">&quot;address&quot;</span>);
    <span class="keywordflow">if</span> (!strcmp(addrstr, <span class="stringliteral">&quot;auto&quot;</span>))
    {
        <span class="comment">// assign automatic address</span>
        <a class="code" href="class_c_s_m_a_mac_layer.html#afdf97d7f96e7f3af317915cb8c67fb46" title="mac address">myMacAddr</a> = <a class="code" href="class_m_a_c_address.html#a020d8e71aa50506e2b29a15833fedfd9">MACAddress::generateAutoAddress</a>();

        <span class="comment">// change module parameter from &quot;auto&quot; to concrete address</span>
        par(<span class="stringliteral">&quot;address&quot;</span>).setStringValue(<a class="code" href="class_c_s_m_a_mac_layer.html#afdf97d7f96e7f3af317915cb8c67fb46" title="mac address">myMacAddr</a>.<a class="code" href="class_m_a_c_address.html#a5eed6450abcdd795b2a3d59828a29802">str</a>().c_str());
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="class_c_s_m_a_mac_layer.html#afdf97d7f96e7f3af317915cb8c67fb46" title="mac address">myMacAddr</a>.<a class="code" href="class_m_a_c_address.html#a8098d36b9f4a40ef61e1a3cb62cb27dd">setAddress</a>(addrstr);
    }
    e-&gt;<a class="code" href="class_interface_entry.html#ac10c228cc65a2c799c798ca75de593dc">setMACAddress</a>(<a class="code" href="class_c_s_m_a_mac_layer.html#afdf97d7f96e7f3af317915cb8c67fb46" title="mac address">myMacAddr</a>);

    <span class="comment">// generate interface identifier for IPv6</span>
    e-&gt;<a class="code" href="class_interface_entry.html#a7fad57b268a57abe1de80d30299d4c45">setInterfaceToken</a>(<a class="code" href="class_c_s_m_a_mac_layer.html#afdf97d7f96e7f3af317915cb8c67fb46" title="mac address">myMacAddr</a>.<a class="code" href="class_m_a_c_address.html#af646c7d6a3dbe4a94465fd3ec144f08f">formInterfaceIdentifier</a>());

    <span class="comment">// MTU on 802.11 = ?</span>
    e-&gt;<a class="code" href="class_interface_entry.html#aaebcf5970e29877b0a4b68ddaaaf540f">setMtu</a>(1500);  <span class="comment">// FIXME</span>

    <span class="comment">// capabilities</span>
    e-&gt;<a class="code" href="class_interface_entry.html#a6f9c79da187d1d56c028b616f3be28fe">setBroadcast</a>(<span class="keyword">true</span>);
    e-&gt;<a class="code" href="class_interface_entry.html#a0b9fca7071b37185a18b6693c3502f69">setMulticast</a>(<span class="keyword">true</span>);
    e-&gt;<a class="code" href="class_interface_entry.html#af207b6ea20ecd9bedd4acfae50a3500f">setPointToPoint</a>(<span class="keyword">false</span>);

    <span class="comment">// add</span>
    <a class="code" href="class_i_interface_table.html">IInterfaceTable</a> *ift = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a>().<a class="code" href="class_module_access.html#a44956ddb52973612afbba0eeecf8bb66">get</a>();
    ift-&gt;<a class="code" href="class_i_interface_table.html#a2159ab6dc917bd6f1b2061980bbdf107">addInterface</a>(e, <span class="keyword">this</span>);
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a7520d042d75476c466a6c22b2f39677a"></a><!-- doxytag: member="CSMAMacLayer::macQueue" ref="a7520d042d75476c466a6c22b2f39677a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cQueue <a class="el" href="class_c_s_m_a_mac_layer.html#a7520d042d75476c466a6c22b2f39677a">CSMAMacLayer::macQueue</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A queue to store packets from upper layer in case another packet is still waiting for transmission.. </p>

<p>Referenced by <a class="el" href="class_c_s_m_a_mac_layer.html#a6df436f9290586658dc48738d7cd2160">handleUpperMsg()</a>, and <a class="el" href="class_c_s_m_a_mac_layer.html#a086c3e39266c68e144bd6443797a4051">receiveChangeNotification()</a>.</p>

</div>
</div>
<a class="anchor" id="afdf97d7f96e7f3af317915cb8c67fb46"></a><!-- doxytag: member="CSMAMacLayer::myMacAddr" ref="afdf97d7f96e7f3af317915cb8c67fb46" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_m_a_c_address.html">MACAddress</a> <a class="el" href="class_c_s_m_a_mac_layer.html#afdf97d7f96e7f3af317915cb8c67fb46">CSMAMacLayer::myMacAddr</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>mac address </p>

<p>Referenced by <a class="el" href="class_c_s_m_a_mac_layer.html#adf48e62e08023a725d932f6fb6d59d28">encapsMsg()</a>, <a class="el" href="class_c_s_m_a_mac_layer.html#a131f9fa39f15a2e1a995a5581ba05fb1">handleLowerMsg()</a>, and <a class="el" href="class_c_s_m_a_mac_layer.html#ade403acd57e58a03f974b7f48a32d734">registerInterface()</a>.</p>

</div>
</div>
<a class="anchor" id="a592653908837e5acbe36dfe7f20efbdd"></a><!-- doxytag: member="CSMAMacLayer::queueLength" ref="a592653908837e5acbe36dfe7f20efbdd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_c_s_m_a_mac_layer.html#a592653908837e5acbe36dfe7f20efbdd">CSMAMacLayer::queueLength</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>length of the queue </p>

<p>Referenced by <a class="el" href="class_c_s_m_a_mac_layer.html#a6df436f9290586658dc48738d7cd2160">handleUpperMsg()</a>, and <a class="el" href="class_c_s_m_a_mac_layer.html#af0b2c470ab7f10fe061cf2daf9907e39">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a8cef547042b1676d1ddce0dea22f0191"></a><!-- doxytag: member="CSMAMacLayer::radioState" ref="a8cef547042b1676d1ddce0dea22f0191" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_radio_state.html#a9b2ff8c4d3f1cdb73af0a9fcea0d5449">RadioState::State</a> <a class="el" href="class_c_s_m_a_mac_layer.html#a8cef547042b1676d1ddce0dea22f0191">CSMAMacLayer::radioState</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Current state of the radio (kept updated by <a class="el" href="class_c_s_m_a_mac_layer.html#a086c3e39266c68e144bd6443797a4051" title="Called by the NotificationBoard whenever a change occurs we&#39;re interested in.">receiveChangeNotification()</a>) </p>

<p>Referenced by <a class="el" href="class_c_s_m_a_mac_layer.html#a6df436f9290586658dc48738d7cd2160">handleUpperMsg()</a>, <a class="el" href="class_c_s_m_a_mac_layer.html#af0b2c470ab7f10fe061cf2daf9907e39">initialize()</a>, and <a class="el" href="class_c_s_m_a_mac_layer.html#a086c3e39266c68e144bd6443797a4051">receiveChangeNotification()</a>.</p>

</div>
</div>
<a class="anchor" id="ab7ea060c217bbfb8a06bc39c1dfeaa9f"></a><!-- doxytag: member="CSMAMacLayer::sendTime" ref="ab7ea060c217bbfb8a06bc39c1dfeaa9f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t <a class="el" href="class_c_s_m_a_mac_layer.html#ab7ea060c217bbfb8a06bc39c1dfeaa9f">CSMAMacLayer::sendTime</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Used to store the last time a message was sent. </p>

<p>Referenced by <a class="el" href="class_c_s_m_a_mac_layer.html#a6df436f9290586658dc48738d7cd2160">handleUpperMsg()</a>.</p>

</div>
</div>
<a class="anchor" id="a4aa3b46aa38d83fd86f2ef499caa48bf"></a><!-- doxytag: member="CSMAMacLayer::timer" ref="a4aa3b46aa38d83fd86f2ef499caa48bf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="class_c_s_m_a_mac_layer.html#a4aa3b46aa38d83fd86f2ef499caa48bf">CSMAMacLayer::timer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Timer for backoff in case the channel is busy. </p>

<p>Referenced by <a class="el" href="class_c_s_m_a_mac_layer.html#a52ea80af0023e1d7002d4bdbc6ae39cc">CSMAMacLayer()</a>, <a class="el" href="class_c_s_m_a_mac_layer.html#a6df436f9290586658dc48738d7cd2160">handleUpperMsg()</a>, <a class="el" href="class_c_s_m_a_mac_layer.html#af0b2c470ab7f10fe061cf2daf9907e39">initialize()</a>, <a class="el" href="class_c_s_m_a_mac_layer.html#a086c3e39266c68e144bd6443797a4051">receiveChangeNotification()</a>, and <a class="el" href="class_c_s_m_a_mac_layer.html#a670e9734cd2d4300fb9dd23f1873409f">~CSMAMacLayer()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_c_s_m_a_mac_layer_8h.html">CSMAMacLayer.h</a></li>
<li><a class="el" href="_c_s_m_a_mac_layer_8cc.html">CSMAMacLayer.cc</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_c_s_m_a_mac_layer.html">CSMAMacLayer</a>      </li>
      <li class="footer">Generated on Fri Nov 18 2011 12:47:12 for INET Framework for OMNeT++/OMNEST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
